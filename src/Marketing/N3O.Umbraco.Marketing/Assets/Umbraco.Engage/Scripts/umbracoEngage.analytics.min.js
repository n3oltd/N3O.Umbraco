window.umbracoEngage=function(e){return e.analytics=function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var t={pageviewGuid:null,version:5,timeOnPage:{start:b()},scrollDepth:{pixels:0,percentage:0},links:[],events:[],videos:[],umbracoForms:[]};var n={FOCUS:"Focus",UNFOCUS_DATA_ENTERED:"UnfocusDataEntered",UNFOCUS_NO_DATA_ENTERED:"UnfocusNoDataEntered"};function o(e){if(null==e)return null;var t=e.querySelector("input[name='FormId'][type='hidden']");return null==t?null:t.value}function r(e){if(null==e)return null;var t=e.querySelector("input[name='FormName'][type='hidden']");return null==t?null:t.value}function i(){return null!=window.sessionStorage&&"function"==typeof window.sessionStorage.setItem&&"function"==typeof window.sessionStorage.getItem}function a(e){return"umbraco-engage-form-"+e}function l(e,t,n){if(null!=n){n.raisedErrors=!0,Array.isArray(n.errors)||(n.errors=[]);var o=c(e),r=s(e),i={timestamp:Math.floor(+new Date/1e3),field:o,fieldKey:r,errorType:t};n.errors.push(i)}}function c(e){var t=u(e);if(!t)return"<UNKNOWN>";var n=document.querySelector("label[for='"+t+"']");return null!=n?n.textContent.replace(/^\s*|[*\s]*$/g,""):t}function u(e){var t=e.id;return t?t.replace(/_\d+$/,""):null}function s(e){return null!=e.dataset.umb?e.dataset.umb.replace(/_\d+$/,""):u(e)}var f={AUTOPLAY:"Autoplay",PLAY:"Play",PAUSE:"Pause",RESUME:"Resume",ENDED:"Ended",SEEK:"Seek"},d={FILE:"File",YOUTUBE:"YouTube",VIMEO:"Vimeo"};function v(e){var t=null,n=null;function o(){null!=n&&(r(),clearTimeout(n),n=null,t=null)}function r(){if(null!=t){var n=b(),o=Math.floor((n-t)/1e3);e(o),t=n}}return{start:function e(){o(),t=b(),n=setTimeout((function(){r(),e()}),1e3)},stop:o,update:r}}function p(e){if(null!=e){var n={name:null,source:d.FILE,url:null,totalTimeWatchedInSeconds:0,totalLengthInSeconds:0,inViewPort:!1,watched:!1,timestamp:Math.floor(+new Date/1e3),events:[]};t.videos.push(n);var o=!0,r=!1,i=v((function(e){n.totalTimeWatchedInSeconds+=e}));e.readyState>0?l():e.addEventListener("loadedmetadata",l,{once:!0,passive:!0}),e.addEventListener("play",(function(){o&&e.autoplay?m(n,f.AUTOPLAY,a()):m(n,r?f.RESUME:f.PLAY,a()),r=!1,o=!1,i.start()}),{passive:!0}),e.addEventListener("pause",(function(){var t=e.currentTime===e.duration;m(n,t?f.ENDED:f.PAUSE,a()),r=!t,i.stop()}),{passive:!0}),e.addEventListener("seeked",(function(){m(n,f.SEEK,a())}),{passive:!0}),e.addEventListener("playing",(function(){n.watched=!0}),{passive:!0}),h(n,e)}function a(){return Math.floor(e.currentTime)}function l(){if(n.totalLengthInSeconds=Math.floor(e.duration),null!=e.currentSrc&&e.currentSrc.length>0){n.url=e.currentSrc;var t=e.currentSrc.split("/");n.name=t[t.length-1]}}}function m(e,t,n){if(null!=e){Array.isArray(e.events)||(e.events=[]);var o={timestamp:Math.floor(+new Date/1e3),action:t,startTimeInVideoInSeconds:n};e.events.push(o)}}function h(e,t){if("function"==typeof window.IntersectionObserver){var n=new IntersectionObserver((function(t){for(var o=0;o<t.length;o++)if(t[o].isIntersecting){e.inViewPort=!0,n.disconnect();break}}),{threshold:1});n.observe(t)}}function g(e,n){if(null==n)return w((function(t){g(e,t)}));var o,r={name:null,source:d.YOUTUBE,url:null,totalTimeWatchedInSeconds:0,totalLengthInSeconds:0,inViewPort:!1,watched:!1,timestamp:Math.floor(+new Date/1e3),events:[]};t.videos.push(r);var i=!1,a=!0,l=e.src.indexOf("autoplay=1")>-1;function c(){return null==o?0:Math.floor(o.playerInfo.currentTime)}var u=v((function(e){r.totalTimeWatchedInSeconds+=e}));function s(){r.totalLengthInSeconds=Math.floor(o.playerInfo.duration),r.url=o.playerInfo.videoUrl,o.playerInfo&&o.playerInfo.videoData&&(r.name=o.playerInfo.videoData.title)}o=new n.Player(e,{events:{onReady:function(){s()},onStateChange:function(e){switch(s(),e.data){case-1:break;case n.PlayerState.ENDED:m(r,f.ENDED,c()),u.stop();break;case n.PlayerState.PLAYING:var t=c();if(a&&l)m(r,f.AUTOPLAY,t);else{if(i){var d=r.events.filter((function(e){return e.action===f.PAUSE}));if(d.length>0){var v=d[d.length-1];null!=v&&Math.abs(t-v.startTimeInVideoInSeconds)>1&&m(r,f.SEEK,t)}}m(r,i?f.RESUME:f.PLAY,t)}i=!1,a=!1,r.watched=!0,u.start();break;case n.PlayerState.PAUSED:t=c();var p=r.events.filter((function(e){return e.action===f.PLAY||e.action===f.RESUME}));if(p.length>0){var h=p[p.length-1];if(null!=h){var g=Math.floor(+new Date/1e3),w=(o.playerInfo&&o.playerInfo.playbackRate||1)*(g-h.timestamp),y=t-h.startTimeInVideoInSeconds,E=Math.abs(w-y);E>1&&E/(w||1)>.1&&m(r,f.SEEK,t)}}m(r,f.PAUSE,t),i=!0,u.stop();case n.PlayerState.BUFFERING:case n.PlayerState.CUED:}}}}),h(r,e)}function w(e){if(void 0!==window.YT)window.YT.loaded?e(window.YT):window.YT.ready((function(){e(window.YT)}));else{var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",t.addEventListener("load",(function(){void 0!==window.YT&&window.YT.ready((function(){e(window.YT)}))}));var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}}function y(e,n){if(null==n)return E((function(t){y(e,t)}));var o,r={name:null,source:d.VIMEO,url:null,totalTimeWatchedInSeconds:0,totalLengthInSeconds:0,inViewPort:!1,watched:!1,timestamp:Math.floor(+new Date/1e3),events:[]};t.videos.push(r);var i=!1,a=!0,l=e.src.indexOf("autoplay=1")>-1,c=v((function(e){r.totalTimeWatchedInSeconds+=e}));(o=new n.Player(e)).getVideoTitle().then((function(e){r.name=e})),o.getVideoUrl().then((function(e){r.url=e}),(function(){r.url=e.src.replace(/\?.*$/,"")})),o.getDuration().then((function(e){r.totalLengthInSeconds=Math.floor(e)})),o.on("play",(function(e){var t=Math.floor(e.seconds);m(r,a&&l?f.AUTOPLAY:i?f.RESUME:f.PLAY,t),i=!1,a=!1,r.watched=!0,c.start()})),o.on("pause",(function(e){var t=Math.floor(e.seconds);m(r,f.PAUSE,t),i=!0,c.stop()})),o.on("ended",(function(e){var t=Math.floor(e.seconds);m(r,f.ENDED,t),c.stop()})),o.on("seeked",(function(e){var t=Math.floor(e.seconds);m(r,f.SEEK,t)})),h(r,e)}function E(e){if(void 0!==window.Vimeo)e(window.Vimeo);else{var t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",t.addEventListener("load",(function(){void 0!==window.Vimeo&&e(window.Vimeo)})),document.body.appendChild(t)}}function b(){return performance&&"function"==typeof performance.now&&performance.now()||+new Date}function S(){var e,n=(e=b(),{totalTimeMillis:Math.floor(e-t.timeOnPage.start),engagedTimeMillis:O.getTimeEngaged()}),o={pixels:t.scrollDepth.pixels,percentage:t.scrollDepth.percentage},r=t.links,i=t.events,a=t.videos;return{timeOnPage:n,scrollDepth:o,links:r,events:i,umbracoForms:t.umbracoForms,videos:a}}function T(e,t){if("function"==typeof navigator.sendBeacon&&"function"==typeof Blob){var n=new Blob([JSON.stringify(t)],{type:"application/json"});navigator.sendBeacon(e,n)}else{var o=new XMLHttpRequest;o.open("POST",e,!1),o.setRequestHeader("Content-Type","application/json");var r=JSON.stringify(t);o.send(r)}}var O=function(){var e,t=r(),n=0,o=!0;function r(){return(new Date).getTime()}function i(){c(),o=!0}function a(){o&&(o=!1,t=r()),window.clearTimeout(e),e=window.setTimeout(i,5e3)}function l(e,t){window.addEventListener?window.addEventListener(e,t):window.attachEvent&&window.attachEvent("on"+e,t)}function c(){if(!o){var e=r();n+=e-t,t=e}}return{init:function(){l("mousedown",a),l("keydown",a),l("scroll",a),l("mousemove",a),e=window.setTimeout(i,5e3)},getTimeEngaged:function(){return c(),n}}}();return{init:function(u){var f,d;t.pageviewGuid=u,function(){function e(){var e=document.documentElement.offsetHeight,n=window.pageYOffset||document.documentElement.scrollTop,o=window.innerHeight+n,r=Math.round(Math.min(o,e)/e*100);r>t.scrollDepth.percentage&&(t.scrollDepth.percentage=r),o>t.scrollDepth.pixels&&(t.scrollDepth.pixels=Math.floor(o))}window.addEventListener("scroll",(n=e,o=100,function(){var e=this,t=arguments,i=function(){r=null,n.apply(e,t)};clearTimeout(r),r=setTimeout(i,o)}),!1),document.addEventListener("DOMContentLoaded",e),e();var n,o,r}(),function(){function e(e){var n=e.target.closest("a");if(null!=n&&null!=n.href&&0!==n.href.length&&(0===e.button||1===e.button)){var o=n.href,r=window.location.origin,i=0===o.indexOf("http")&&0!==o.indexOf(r),a=/\.(?:pdf|doc|docx)(?:\?|$)/i.test(o),l=0===o.indexOf("#")||0===o.indexOf(r+"/#"),c=0===o.indexOf("mailto:")||0===o.indexOf("tel:");(i||a||l||c)&&t.links.push({href:o,timeClicked:new Date})}}document.addEventListener("click",e),document.addEventListener("auxclick",e)}(),O.init(),function(){Object.defineProperty(HTMLMediaElement.prototype,"playing",{get:function(){return this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2}});var e=document.querySelectorAll("video");if(0!==e.length)for(var t=0;t<e.length;t++)p(e[t])}(),0!==(d=document.querySelectorAll("iframe[src*='youtube.com'], iframe[src*='youtube-nocookie.com']")).length&&(d.forEach((function(e){var t=e.getAttribute("src");t&&-1===t.indexOf("enablejsapi=1")&&(t+=(-1===t.indexOf("?")?"?":"&")+"enablejsapi=1",e.setAttribute("src",t))})),w((function(e){if("function"==typeof e.Player)for(var t=0;t<d.length;t++)g(d[t],e)}))),0!==(f=document.querySelectorAll("iframe[src*='player.vimeo.com/video']")).length&&E((function(e){if("function"==typeof e.Player)for(var t=0;t<f.length;t++)y(f[t],e)})),[].slice.call(document.querySelectorAll("form")).filter((function(e){var t=o(e),n=r(e);return null!=t&&null!=n&&!e.hasAttribute("engage-no-tracking")})).forEach((function(e){!function(e){var u=o(e),f=function(e,t){if(i()){var n=a(e),o=sessionStorage[n];if(t&&sessionStorage.removeItem(n),null!=o)try{return JSON.parse(o)}catch(e){return null}}}(u,!0)||{id:u,name:r(e),submitted:!1,raisedErrors:!1,timeStart:null,timeEnd:null,inViewPort:!1,translated:!1,actions:[],errors:[]};h(f),t.umbracoForms.push(f),[].slice.call(e.querySelectorAll("input,textarea,select")).filter((function(e){return"hidden"!==e.type&&"button"!==e.type&&"submit"!==e.type&&!e.hasAttribute("engage-no-tracking")})).forEach((function(e){!function(e,t){function o(n){!function(e,t,n){if(null!=n){Array.isArray(n.actions)||(n.actions=[]);var o=c(e),r=s(e),i={timestamp:Math.floor(+new Date/1e3),field:o,fieldKey:r,action:t};n.actions.push(i)}}(e,n,t)}function r(){null==t.timeStart&&(t.timeStart=Math.floor(+new Date/1e3))}e.addEventListener("focus",(function(){o(n.FOCUS)}),{passive:!0}),e.addEventListener("blur",(function(){var t=function(e){return null==e?"":e.value}(e);null==t||0===t.length?o(n.UNFOCUS_NO_DATA_ENTERED):o(n.UNFOCUS_DATA_ENTERED)}),{passive:!0}),e.addEventListener("keyup",r,{passive:!0,once:!0}),e.addEventListener("change",r,{passive:!0,once:!0}),e.addEventListener("invalid",(function(){l(e,"validation",t)}),{passive:!0});var i=e.parentNode.querySelector("span[data-valmsg-for]");if(null!=i){var a={attributes:!0,attributeFilter:["class"],attributeOldValue:!0};new MutationObserver((function(n){for(var o=0;o<n.length;o++){var r=n[o];"attributes"===r.type&&r.target.className.indexOf("error")>-1&&r.oldValue.indexOf("valid")>-1&&l(e,"validation",t)}})).observe(i,a)}}(e,f)}));var d=!0;if(d){var v=document.createElement("input");v.type="hidden",v.name="__umbracoEngageAnalyticsPageviewId",v.value=t.pageviewGuid;var p=e.querySelector("input");null!=p?e.insertBefore(v,p):e.appendChild(v)}var m=e.onsubmit;function h(e){var t=document.querySelector("html"),n=document.querySelector("title");function o(){t&&t.classList.contains("translated-ltr")||t.classList.contains("translated-rtl")||n&&n.hasAttribute("_msttexthash")?e.translated=!0:e.translated=!1}const r=new MutationObserver(o),i={attributes:!0};r.observe(t,i),r.observe(n,i)}e.onsubmit=function(n){if("function"==typeof m&&m.apply(e,arguments),!d||null!=n.submitter&&n.submitter.classList.contains("cancel")){!function(e){if(i()){var t=JSON.stringify(e),n=a(e.id);sessionStorage[n]=t}}(f);var o=t.umbracoForms.indexOf(f);-1!==o&&t.umbracoForms.splice(o,1)}else f.submitted=!0,f.timeEnd=Math.floor(+new Date/1e3)},function(e,t){if("function"==typeof window.IntersectionObserver){var n=new IntersectionObserver(o,{threshold:0});n.observe(t)}function o(t){for(var o=0;o<t.length;o++)if(t[o].isIntersecting){e.inViewPort=!0,n.disconnect();break}}}(f,e)}(e)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&function(){if(null==t.pageviewGuid)return;var e=S();T("/umbraco/engage/pagedata/collect?version="+t.version+"&pageviewGuid="+t.pageviewGuid,e),function(){t.links.length=0,t.events.length=0;for(var e=0;e<t.videos.length;e++)t.videos[e].events.length=0;for(var n=0;n<t.umbracoForms.length;n++){var o=t.umbracoForms[n];o.actions.length=0,o.errors.length=0}}()}()}),!1),"function"==typeof e.init&&e.init()},trackEvent:function(e){t.events.push(e),T("/umbraco/engage/pagedata/collectevent",e)},getClientSideData:S,video:{trackVideoElement:p,trackYouTubeVideo:g,trackVimeoVideo:y}}}(),e}(window.umbracoEngage||{}),window.umbEngage=window.umbEngage||function(){var e={event:{send:function(e){e.timestamp=parseInt(+new Date/1e3,10),umbracoEngage.analytics.trackEvent(e)}}};var t={event:{argumentParser:function(e){for(var t={},n=0;n<e.length;n++){var o=e[n];if("string"==typeof o)switch(n){case 0:break;case 1:t.hitType=o;break;case 2:t.category=o;break;case 3:t.action=o;break;case 4:t.label=o}else if("number"==typeof o)t.value=o;else if("object"==typeof o){Object.assign(t,o);break}}return t},api:function(){return e.event}}},n=[];function o(e,o){if("string"==typeof e&&""!==o){var r=Array.prototype.slice.call(arguments);if("[object Object]"===Object.prototype.toString.call(o)){var i=o.eventCategory,a=o.eventAction,l=o.eventLabel,c=o.eventValue;r=[e,o=o.hitType,i,a,l,c]}if("string"==typeof o&&""!==o){var u=t[o];if(u){var s=u.argumentParser(r),f=function(e){for(var t=!1,o={cancel:function(){t=!0},fields:e},r=0;r<n.length;r++)n[r](o);return t}(s);if(!f){var d=u.api(),v=null;for(var p in d){if(d.hasOwnProperty(p))if(new RegExp("^(?:([^.]+)\\.)?"+p+"$","i").test(e)){v=d[p];break}}if(v)try{v(s)}catch(e){}}}}}}return o.onSendEvent=function(e){if("function"!=typeof e)throw new Error("umbEngage.onSendEvent(callback): callback should be a function");return n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}},o}();